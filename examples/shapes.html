<!DOCTYPE html>
<html>
<head>
	<title>Shapes Example - Physijs</title>
	<script type="text/javascript" src="lib/three.min.js"></script>
	<script type="text/javascript" src="../dist/physi.js"></script>
	<link rel="stylesheet" type="text/css" href="styles.css"/>
</head>
<body>
<script type="text/javascript">
	var renderer = new THREE.WebGLRenderer({ antialias: true });
	renderer.setClearColor( new THREE.Color( 0xffffff ) );
	renderer.setSize( window.innerWidth, window.innerHeight );
	document.body.appendChild( renderer.domElement );

	var scene = new physijs.Scene( '../dist/physijs-worker.js' );
	var camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 100 );
	camera.position.set( 0, 5, 10 );
	camera.lookAt( new THREE.Vector3( 0, 0, 0 ) );

	// create geometries
	var box_geometry = new THREE.BoxGeometry( 0.5, 0.5, 0.5 );
	var cylinder_geometry = new THREE.CylinderGeometry( 0.3, 0.3, 0.5 );
	var sphere_geometry = new THREE.SphereGeometry( 0.3 );
	var plane_geometry = new THREE.PlaneGeometry( 0.6, 0.6 );

	// create materials
	var normal_material = new THREE.MeshNormalMaterial();

	(function render() {
		requestAnimationFrame( render );
		renderer.render( scene, camera );
	})();

	var physics_framerate = 1000 / 60;
	function onStep( ticks ) {
		setTimeout( scene.step.bind( scene, physics_framerate / 1000, undefined, onStep ), physics_framerate );

		// every 100ms spawn a new object
		if ( ticks % 100 === 0 ) {
			var object_selector = ( ticks / 100 ) % 4;
			var mesh;

			if ( object_selector === 0 ) {
				mesh = new physijs.BoxMesh( box_geometry, normal_material, { mass: 0.5 } );
			} else if ( object_selector === 1 ) {
				mesh = new physijs.SphereMesh( sphere_geometry, normal_material, { mass: 0.3 } );
			} else if ( object_selector === 2 ) {
				mesh = new physijs.PlaneMesh( plane_geometry, normal_material, { mass: 0.05 } );
			} else if ( object_selector === 3 ) {
				mesh = new physijs.CylinderMesh( cylinder_geometry, normal_material, { mass: 0.6 } );
			}

			if ( ticks === 0 ) {
				mesh.mass = 0;
			} else {
				mesh.position.set( 0, 3, 0 );
			}

			scene.add( mesh );
		}
	}
	onStep( 0 );

</script>
</body>
</html>