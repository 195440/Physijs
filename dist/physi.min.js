!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.physijs=e()}(this,function(){"use strict";function t(t,e){THREE.Scene.call(this),this.initializeWorker(t,e)}function e(){return p++}function o(t,o,s){if(null==s)throw new Error("Physijs: attempted to create rigid body without specifying mass");THREE.Mesh.call(this,t,o),this.physijs_id=e(),this._mass=s||1/0}function s(t,e,s){o.call(this,t,e,s)}function i(t){var e,o={};if(!(t instanceof s))throw new Error("Physijs: unable to determine rigid body definition for mesh");return t.geometry.computeBoundingSphere(),e=n.SPHERE,o.radius=t.geometry.boundingSphere.radius,{body_id:t.physijs_id,body_type:e,body_definition:o,mass:t.mass}}t.prototype=Object.create(THREE.Scene.prototype),t.prototype.constructor=t;var r={INITIALIZE:"INITIALIZE",ADD_RIGIDBODY:"ADD_RIGIDBODY",SET_RIGIDBODY_MASS:"SET_RIGIDBODY_MASS"};t.prototype.initializeWorker=function(t,e){this.worker=new Worker(t),this.worker.addEventListener("message",function(){console.log("scene got message with",arguments)}),this.postMessage(r.INITIALIZE,e||{})},t.prototype.postMessage=function(t,e){this.worker.postMessage({type:t,parameters:e})};var n={SPHERE:"SPHERE"},p=0;o.prototype=Object.create(THREE.Mesh.prototype),o.prototype.constructor=o,Object.defineProperty(o.prototype,"mass",{get:function(){return this._mass},set:function(t){this._mass=t,null!=this.parent&&this.parent.setRigidBodyMass(this,t)}}),s.prototype=Object.create(o.prototype),s.prototype.constructor=s,t.prototype.add=function(t){THREE.Scene.prototype.add.call(this,t),t instanceof o&&this.postMessage(r.ADD_RIGIDBODY,i(t))},t.prototype.setRigidBodyMass=function(t,e){this.postMessage(r.SET_RIGIDBODY_MASS,{body_id:t.physijs_id,mass:e})};var a={Mesh:o,SphereMesh:s,Scene:t};return a});